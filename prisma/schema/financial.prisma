// Financial Management Models  
// Payments, refunds, and revenue tracking

// Payment Processing - Transaction management
model Payment {
  id              String        @id @default(cuid())
  bookingId       String
  amount          Float
  currency        String        @default("THB") // Thai Baht
  paymentMethod   PaymentMethod
  status          PaymentStatus @default(PENDING)
  
  // Transaction Details
  transactionId   String?       // External payment gateway transaction ID
  gatewayResponse Json?         // Raw response from payment gateway
  
  // Audit & Metadata
  paidAt          DateTime?     // When payment was completed
  description     String?       // Payment description or memo
  notes           String?       // Internal staff notes
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  // Relations
  booking         Booking       @relation(fields: [bookingId], references: [id])
  refunds         Refund[]

  @@index([bookingId])
  @@index([paymentMethod])
  @@map("payments")
}

// Refund Management - Handle payment reversals
model Refund {
  id          String       @id @default(cuid())
  paymentId   String
  amount      Float        // Refund amount (can be partial)
  reason      String       // Reason for refund
  status      RefundStatus @default(PENDING)
  processedAt DateTime?    // When refund was processed
  notes       String?      // Additional notes about refund
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  // Relations
  payment     Payment      @relation(fields: [paymentId], references: [id])

  @@index([paymentId])
  @@index([status])
  @@map("refunds")
}

// Daily Revenue Analytics - Key performance metrics
model DailyRevenue {
  id             String   @id @default(cuid())
  date           DateTime @unique @db.Date // Date for the revenue data
  roomRevenue    Float    @default(0)      // Revenue from room bookings
  serviceRevenue Float    @default(0)      // Revenue from additional services
  totalRevenue   Float    @default(0)      // Total combined revenue
  occupancyRate  Float    @default(0)      // Percentage of rooms occupied
  adr            Float    @default(0)      // Average Daily Rate
  revpar         Float    @default(0)      // Revenue Per Available Room
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@index([date])
  @@map("daily_revenue")
}